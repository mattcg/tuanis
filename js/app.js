!function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o="function"==typeof require&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(require){"use strict";require("./controls")},{"./controls":2}],3:[function(require,module){"use strict";function Controls(src,opt,scale){this.data={sheet:null},this.forms={src:src,opt:opt,scale:scale}}module.exports=Controls,Controls.prototype.sheet=function(sheet){return arguments.length<1?this.data.sheet:(this.data.sheet=sheet,void 0)},Controls.prototype.source=function(src){return arguments.length<1?this.forms.src.src.value:(this.forms.src.src.value=src||"",void 0)},Controls.prototype.code=function(code){return arguments.length<1?this.forms.opt.code.value:(code&&(this.forms.opt.code.value=code),void 0)},Controls.prototype.stat=function(stat){return arguments.length<1?this.forms.opt.stat.value:(stat&&(this.forms.opt.stat.value=stat),void 0)},Controls.prototype.scale=function(scale){var i,l,brewer,form=this.forms.scale;{if(!scale){for(i=0,l=form.brewer.length;l>i;i++)if(form.brewer[i].checked){brewer=form.brewer[i].value;break}return{brewer:brewer,stops:form.stops.valueAsNumber,type:form.type.value}}if(scale.stops&&(form.stops.value=scale.stops),scale.type&&(form.type.value=scale.type),scale.brewer)for(i=0,l=form.brewer.length;l>i;i++)if(scale.brewer===form.brewer[i].value){form.brewer[i].checked=!0;break}}},Controls.prototype.disable=function(){this.forms.src.load.setAttribute("disabled",""),this.forms.opt.show.setAttribute("disabled",""),this.forms.opt.code.setAttribute("disabled",""),this.forms.opt.stat.setAttribute("disabled","")},Controls.prototype.enable=function(){this.forms.src.load.removeAttribute("disabled"),this.forms.opt.show.removeAttribute("disabled"),this.forms.opt.code.removeAttribute("disabled"),this.forms.opt.stat.removeAttribute("disabled")},Controls.prototype.selects=function(fields){var i,l,field,html;for(html="",i=0,l=fields.length;l>i;i++)field=fields[i],html+='<option value="'+field+'">'+field+"</option>";this.forms.opt.code.innerHTML=html,this.forms.opt.stat.innerHTML=html,this.forms.opt.code.selectedIndex=0,this.forms.opt.stat.selectedIndex=1}},{}],4:[function(require,module,exports){function promote(parent,key){if(0==parent[key].length)return parent[key]={};var t={};for(var i in parent[key])t[i]=parent[key][i];return parent[key]=t,t}function parse(parts,parent,key,val){var part=parts.shift();if(part){var obj=parent[key]=parent[key]||[];"]"==part?isArray(obj)?""!=val&&obj.push(val):"object"==typeof obj?obj[objectKeys(obj).length]=val:obj=parent[key]=[parent[key],val]:~indexOf(part,"]")?(part=part.substr(0,part.length-1),!isint.test(part)&&isArray(obj)&&(obj=promote(parent,key)),parse(parts,obj,part,val)):(!isint.test(part)&&isArray(obj)&&(obj=promote(parent,key)),parse(parts,obj,part,val))}else isArray(parent[key])?parent[key].push(val):parent[key]="object"==typeof parent[key]?val:"undefined"==typeof parent[key]?val:[parent[key],val]}function merge(parent,key,val){if(~indexOf(key,"]")){var parts=key.split("[");parts.length,parse(parts,parent,"base",val)}else{if(!isint.test(key)&&isArray(parent.base)){var t={};for(var k in parent.base)t[k]=parent.base[k];parent.base=t}set(parent.base,key,val)}return parent}function parseObject(obj){var ret={base:{}};return forEach(objectKeys(obj),function(name){merge(ret,name,obj[name])}),ret.base}function parseString(str){return reduce(String(str).split("&"),function(ret,pair){var eql=indexOf(pair,"="),brace=lastBraceInKey(pair),key=pair.substr(0,brace||eql),val=pair.substr(brace||eql,pair.length),val=val.substr(indexOf(val,"=")+1,val.length);return""==key&&(key=pair,val=""),""==key?ret:merge(ret,decode(key),decode(val))},{base:{}}).base}function stringifyString(str,prefix){if(!prefix)throw new TypeError("stringify expects an object");return prefix+"="+encodeURIComponent(str)}function stringifyArray(arr,prefix){var ret=[];if(!prefix)throw new TypeError("stringify expects an object");for(var i=0;i<arr.length;i++)ret.push(stringify(arr[i],prefix+"["+i+"]"));return ret.join("&")}function stringifyObject(obj,prefix){for(var key,ret=[],keys=objectKeys(obj),i=0,len=keys.length;len>i;++i)key=keys[i],null==obj[key]?ret.push(encodeURIComponent(key)+"="):ret.push(stringify(obj[key],prefix?prefix+"["+encodeURIComponent(key)+"]":encodeURIComponent(key)));return ret.join("&")}function set(obj,key,val){var v=obj[key];void 0===v?obj[key]=val:isArray(v)?v.push(val):obj[key]=[v,val]}function lastBraceInKey(str){for(var brace,c,len=str.length,i=0;len>i;++i)if(c=str[i],"]"==c&&(brace=!1),"["==c&&(brace=!0),"="==c&&!brace)return i}function decode(str){try{return decodeURIComponent(str.replace(/\+/g," "))}catch(err){return str}}var toString=Object.prototype.toString,indexOf="function"==typeof Array.prototype.indexOf?function(arr,el){return arr.indexOf(el)}:function(arr,el){for(var i=0;i<arr.length;i++)if(arr[i]===el)return i;return-1},isArray=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)},objectKeys=Object.keys||function(obj){var ret=[];for(var key in obj)ret.push(key);return ret},forEach="function"==typeof Array.prototype.forEach?function(arr,fn){return arr.forEach(fn)}:function(arr,fn){for(var i=0;i<arr.length;i++)fn(arr[i])},reduce=function(arr,fn,initial){if("function"==typeof arr.reduce)return arr.reduce(fn,initial);for(var res=initial,i=0;i<arr.length;i++)res=fn(res,arr[i]);return res},isint=/^[0-9]+$/;exports.parse=function(str){return null==str||""==str?{}:"object"==typeof str?parseObject(str):parseString(str)};var stringify=exports.stringify=function(obj,prefix){return isArray(obj)?stringifyArray(obj,prefix):"[object Object]"==toString.call(obj)?stringifyObject(obj,prefix):"string"==typeof obj?stringifyString(obj,prefix):prefix+"="+encodeURIComponent(String(obj))}},{}],5:[function(require,module,exports){"use strict";function stripe(svg){var pattern,defs,path,svgNs,svgDoc;svgNs="http://www.w3.org/2000/svg",svgDoc=svg.ownerDocument,svg.getElementById("stripe")||(defs=svgDoc.getElementsByTagName("defs")[0],defs||(defs=svgDoc.createElementNS(svgNs,"defs"),svg.appendChild(defs)),pattern=defs.appendChild(svgDoc.createElementNS(svgNs,"pattern")),pattern.id="stripe",pattern.setAttribute("patternUnits","userSpaceOnUse"),pattern.setAttribute("x","0"),pattern.setAttribute("y","0"),pattern.setAttribute("width","4"),pattern.setAttribute("height","6"),path=pattern.appendChild(svgDoc.createElementNS(svgNs,"path")),path.setAttribute("d","M 0 0 4 0"),path.style.stroke="#c0c0c0",path.style.fill="none")}function tip(map){var container,hide,svg=map.svg;container=document.createElement("div"),container.id="map-tip",container.style.display="none",container.innerHTML="<h1></h1><p></p>",document.body.appendChild(container),hide=function(){container.style.display="none",container.removeAttribute("data-id")},svg.addEventListener("mouseout",hide,!1),svg.addEventListener("mousemove",function(event){var code,target=event.target,id=target.id;return"path"!==target.tagName?hide():(container.style.top=event.clientY+"px",container.style.left=event.clientX+"px",container.getAttribute("data-id")!==id&&(code=map.code(id),container.style.display="block",container.children[0].textContent=map.canton(code),container.children[1].textContent=map.stat(code,!0),container.setAttribute("data-id",id)),void 0)},!1)}function make(){var svg=document.getElementById("map").contentDocument.rootElement;map=new Map(svg),stripe(svg),tip(map)}var map,Map=require("./map/Map");exports.update=function(stats,scale){map||make(),map.stats(stats),exports.scale(scale)},exports.scale=function(scale){map&&map.stats()&&map.scale(scale.brewer,scale.stops,scale.type)},exports.clear=function(){map&&map.clear()}},{"./map/Map":6}],7:[function(require,module,exports){"use strict";function parse(id,json,cb){var feed,rows=[];try{feed=JSON.parse(json).feed}catch(err){return cb(new Error("Error while parsing data from Google Spreadsheets."))}return!feed.entry||feed.entry.length<1?cb(new Error("That spreadsheet seems to be empty.")):(feed.entry.forEach(function(entry){var row={};rows.push(row),Object.keys(entry).forEach(function(key){"gsx$"===key.substr(0,4)&&(row[key.substr(4)]=entry[key].$t)})}),cb(null,new Sheet({id:id,rows:rows,title:feed.title.$t})),void 0)}var Sheet=require("./sheet/Sheet");exports.url=function(id){return"https://docs.google.com/spreadsheet/ccc?key="+id},exports.load=function(src,cb){var match,id,xhr;if(/^[A-Za-z0-9\-_]+$/.test(src))id=src;else{if(match=/key=([A-Za-z0-9\-_]+)/.exec(src),!match||!match[1])return cb(new Error("Please enter a valid Google Spreadsheets URL."));id=match[1]}xhr=new XMLHttpRequest,xhr.open("GET","https://spreadsheets.google.com/feeds/list/"+id+"/od6/public/values?alt=json"),xhr.addEventListener("load",function(){return 200!==xhr.status?cb(new Error("Unable to fetch the spreadsheet. Have you published it to the Web yet?")):(parse(id,xhr.responseText,cb),void 0)},!1),xhr.addEventListener("error",function(){return cb(new Error("Unable to fetch the spreadsheet. Are you connected to the Internet?"))},!1),xhr.send()}},{"./sheet/Sheet":8}],8:[function(require,module){"use strict";function Sheet(data){this.data=data}module.exports=Sheet,Sheet.prototype.title=function(){return this.data.title},Sheet.prototype.id=function(){return this.data.id},Sheet.prototype.fields=function(){return Object.keys(this.data.rows[0])},Sheet.prototype.stats=function(codeField,statField){var stats={};return this.data.rows.forEach(function(row){var code;code=row[codeField],stats[code]=row[statField]}),stats}},{}],2:[function(require){"use strict";function colors(form){Array.prototype.forEach.call(form.brewer,function(input){var container=document.createElement("div");container.className="brewer",chroma.brewer[input.value].forEach(function(color){var swatch=document.createElement("div");swatch.style.backgroundColor=color,swatch.className="swatch",container.appendChild(swatch)}),input.parentNode.appendChild(container)})}function popstate(event){var params,update;if((!event||event.state)&&(params=state.params(),controls.scale(params),params.id?controls.source(sheet.url(params.id)):controls.source(""),params.id)){if(update=function(sheet){var stats;controls.sheet(sheet),controls.enable(),controls.selects(sheet.fields()),controls.code(params.code),controls.stat(params.stat),stats=sheet.stats(controls.code(),controls.stat()),map.update(stats,params)},controls.sheet()&&controls.sheet().id()===params.id)return update(controls.sheet());controls.disable(),sheet.load(params.id,function(err,sheet){return err?alert(err.toString()):(update(sheet),void 0)})}}var controls,chroma=require("chroma-js"),Controls=require("./controls/Controls"),map=require("./map"),sheet=require("./sheet"),state=require("./state");document.addEventListener("submit",function(event){return event.preventDefault(),!1},!1),require("domready")(function(){var srcForm,optForm,scaleForm;state.controls()&&(document.body.className="controls"),srcForm=document.getElementById("load-controls"),optForm=document.getElementById("select-controls"),scaleForm=document.getElementById("scale-controls"),colors(scaleForm),controls=new Controls(srcForm,optForm,scaleForm),srcForm.addEventListener("submit",function(){controls.disable(),sheet.load(controls.source(),function(err,sheet){return err?alert(err.toString()):(controls.sheet(sheet),controls.enable(),controls.selects(sheet.fields()),map.clear(),state.update(sheet.id(),sheet.title(),controls),void 0)})},!1),optForm.addEventListener("submit",function(){var stats,sheet=controls.sheet();stats=sheet.stats(controls.code(),controls.stat()),map.update(stats,controls.scale()),state.update(controls)},!1),scaleForm.addEventListener("change",function(){map.scale(controls.scale()),state.update(controls)},!1),window.addEventListener("popstate",popstate,!1),popstate()})},{"./controls/Controls":3,"./map":5,"./sheet":7,"./state":9,"chroma-js":10,domready:11}],10:[function(require,module,exports){!function(){var Color,ColorScale,K,PITHIRD,TWOPI,X,Y,Z,brewer,chroma,clip_rgb,colors,cos,css2rgb,hex2rgb,hsi2rgb,hsl2rgb,hsv2rgb,lab2lch,lab2rgb,lab_xyz,lch2lab,lch2rgb,limit,luminance,luminance_x,rgb2hex,rgb2hsi,rgb2hsl,rgb2hsv,rgb2lab,rgb2lch,rgb_xyz,root,type,unpack,xyz_lab,xyz_rgb,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;root="undefined"!=typeof exports&&null!==exports?exports:this,chroma=null!=(_ref=root.chroma)?_ref:root.chroma={},"undefined"!=typeof module&&null!==module&&(module.exports=chroma),Color=function(){function Color(x,y,z,m){var me,me_rgb,_ref1;me=this,null==x&&null==y&&null==z&&null==m&&(x=[255,0,255]),"array"===type(x)&&3===x.length&&(null==m&&(m=y),_ref1=x,x=_ref1[0],y=_ref1[1],z=_ref1[2]),"string"===type(x)?m="hex":null==m&&(m="rgb"),"rgb"===m?me._rgb=[x,y,z]:"hsl"===m?me._rgb=hsl2rgb(x,y,z):"hsv"===m?me._rgb=hsv2rgb(x,y,z):"hex"===m?me._rgb=hex2rgb(x):"lab"===m?me._rgb=lab2rgb(x,y,z):"lch"===m?me._rgb=lch2rgb(x,y,z):"hsi"===m&&(me._rgb=hsi2rgb(x,y,z)),me_rgb=clip_rgb(me._rgb)}return Color.prototype.rgb=function(){return this._rgb},Color.prototype.hex=function(){return rgb2hex(this._rgb)},Color.prototype.toString=function(){return this.hex()},Color.prototype.hsl=function(){return rgb2hsl(this._rgb)},Color.prototype.hsv=function(){return rgb2hsv(this._rgb)},Color.prototype.lab=function(){return rgb2lab(this._rgb)},Color.prototype.lch=function(){return rgb2lch(this._rgb)},Color.prototype.hsi=function(){return rgb2hsi(this._rgb)},Color.prototype.luminance=function(){return luminance(this._rgb)},Color.prototype.name=function(){var h,k;h=this.hex();for(k in chroma.colors)if(h===chroma.colors[k])return k;return h},Color.prototype.interpolate=function(f,col,m){var dh,hue,hue0,hue1,lbv,lbv0,lbv1,me,sat,sat0,sat1,xyz0,xyz1;if(me=this,null==m&&(m="rgb"),"string"===type(col)&&(col=new Color(col)),"hsl"===m||"hsv"===m||"lch"===m||"hsi"===m)return"hsl"===m?(xyz0=me.hsl(),xyz1=col.hsl()):"hsv"===m?(xyz0=me.hsv(),xyz1=col.hsv()):"hsi"===m?(xyz0=me.hsi(),xyz1=col.hsi()):"lch"===m&&(xyz0=me.lch(),xyz1=col.lch()),"h"===m.substr(0,1)?(hue0=xyz0[0],sat0=xyz0[1],lbv0=xyz0[2],hue1=xyz1[0],sat1=xyz1[1],lbv1=xyz1[2]):(lbv0=xyz0[0],sat0=xyz0[1],hue0=xyz0[2],lbv1=xyz1[0],sat1=xyz1[1],hue1=xyz1[2]),isNaN(hue0)||isNaN(hue1)?isNaN(hue0)?isNaN(hue1)?hue=void 0:(hue=hue1,(1===lbv0||0===lbv0)&&(sat=sat1)):(hue=hue0,(1===lbv1||0===lbv1)&&(sat=sat0)):(dh=hue1>hue0&&hue1-hue0>180?hue1-(hue0+360):hue0>hue1&&hue0-hue1>180?hue1+360-hue0:hue1-hue0,hue=hue0+f*dh),null==sat&&(sat=sat0+f*(sat1-sat0)),lbv=lbv0+f*(lbv1-lbv0),"h"===m.substr(0,1)?new Color(hue,sat,lbv,m):new Color(lbv,sat,hue,m);if("rgb"===m)return xyz0=me._rgb,xyz1=col._rgb,new Color(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),m);if("lab"===m)return xyz0=me.lab(),xyz1=col.lab(),new Color(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),m);throw"color mode "+m+" is not supported"},Color.prototype.darken=function(amount){var lch,me;return null==amount&&(amount=20),me=this,lch=me.lch(),lch[0]-=amount,chroma.lch(lch)},Color.prototype.darker=function(amount){return this.darken(amount)},Color.prototype.brighten=function(amount){return null==amount&&(amount=20),this.darken(-amount)},Color.prototype.brighter=function(amount){return this.brighten(amount)},Color.prototype.saturate=function(amount){var lch,me;return null==amount&&(amount=20),me=this,lch=me.lch(),lch[1]+=amount,chroma.lch(lch)},Color.prototype.desaturate=function(amount){return null==amount&&(amount=20),this.saturate(-amount)},Color}(),hex2rgb=function(hex){var b,g,r,rgb,u;if(hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return(4===hex.length||7===hex.length)&&(hex=hex.substr(1)),3===hex.length&&(hex=hex.split(""),hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),u=parseInt(hex,16),r=u>>16,g=255&u>>8,b=255&u,[r,g,b];if(rgb=css2rgb(hex))return rgb;throw"unknown color: "+hex},css2rgb=function(css){var hsl,i,m,rgb;if(null!=chroma.colors&&chroma.colors[css])return hex2rgb(chroma.colors[css]);if(m=css.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/))return m.slice(1,4);if(m=css.match(/rgb\(\s*(\-?\d+)%,\s*(\-?\d+)%\s*,\s*(\-?\d+)%\s*\)/)){rgb=m.slice(1,4);for(i in rgb)rgb[i]=Math.round(2.55*rgb[i]);return rgb}return(m=css.match(/hsl\(\s*(\-?\d+),\s*(\-?\d+)%\s*,\s*(\-?\d+)%\s*\)/))?(hsl=m.slice(1,4),hsl[1]*=.01,hsl[2]*=.01,hsl2rgb(hsl)):void 0},rgb2hex=function(){var b,g,r,str,u,_ref1;return _ref1=unpack(arguments),r=_ref1[0],g=_ref1[1],b=_ref1[2],u=r<<16|g<<8|b,str="000000"+u.toString(16),"#"+str.substr(str.length-6)},hsv2rgb=function(){var b,f,g,h,i,p,q,r,s,t,v,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;if(_ref1=unpack(arguments),h=_ref1[0],s=_ref1[1],v=_ref1[2],v*=255,0===s)r=g=b=v;else switch(360===h&&(h=0),h>360&&(h-=360),0>h&&(h+=360),h/=60,i=Math.floor(h),f=h-i,p=v*(1-s),q=v*(1-s*f),t=v*(1-s*(1-f)),i){case 0:_ref2=[v,t,p],r=_ref2[0],g=_ref2[1],b=_ref2[2];break;case 1:_ref3=[q,v,p],r=_ref3[0],g=_ref3[1],b=_ref3[2];break;case 2:_ref4=[p,v,t],r=_ref4[0],g=_ref4[1],b=_ref4[2];break;case 3:_ref5=[p,q,v],r=_ref5[0],g=_ref5[1],b=_ref5[2];break;case 4:_ref6=[t,p,v],r=_ref6[0],g=_ref6[1],b=_ref6[2];break;case 5:_ref7=[v,p,q],r=_ref7[0],g=_ref7[1],b=_ref7[2]}return r=Math.round(r),g=Math.round(g),b=Math.round(b),[r,g,b]},rgb2hsv=function(){var b,delta,g,h,max,min,r,s,v,_ref1;return _ref1=unpack(arguments),r=_ref1[0],g=_ref1[1],b=_ref1[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min,v=max/255,0===max?(h=void 0,s=0):(s=delta/max,r===max&&(h=(g-b)/delta),g===max&&(h=2+(b-r)/delta),b===max&&(h=4+(r-g)/delta),h*=60,0>h&&(h+=360)),[h,s,v]},hsl2rgb=function(){var b,c,g,h,i,l,r,s,t1,t2,t3,_i,_ref1,_ref2;if(_ref1=unpack(arguments),h=_ref1[0],s=_ref1[1],l=_ref1[2],0===s)r=g=b=255*l;else{for(t3=[0,0,0],c=[0,0,0],t2=.5>l?l*(1+s):l+s-l*s,t1=2*l-t2,h/=360,t3[0]=h+1/3,t3[1]=h,t3[2]=h-1/3,i=_i=0;2>=_i;i=++_i)t3[i]<0&&(t3[i]+=1),t3[i]>1&&(t3[i]-=1),c[i]=6*t3[i]<1?t1+6*(t2-t1)*t3[i]:2*t3[i]<1?t2:3*t3[i]<2?t1+6*(t2-t1)*(2/3-t3[i]):t1;_ref2=[Math.round(255*c[0]),Math.round(255*c[1]),Math.round(255*c[2])],r=_ref2[0],g=_ref2[1],b=_ref2[2]}return[r,g,b]},rgb2hsl=function(r,g,b){var h,l,max,min,s,_ref1;return void 0!==r&&3===r.length&&(_ref1=r,r=_ref1[0],g=_ref1[1],b=_ref1[2]),r/=255,g/=255,b/=255,min=Math.min(r,g,b),max=Math.max(r,g,b),l=(max+min)/2,max===min?(s=0,h=void 0):s=.5>l?(max-min)/(max+min):(max-min)/(2-max-min),r===max?h=(g-b)/(max-min):g===max?h=2+(b-r)/(max-min):b===max&&(h=4+(r-g)/(max-min)),h*=60,0>h&&(h+=360),[h,s,l]},K=18,X=.95047,Y=1,Z=1.08883,lab2rgb=function(l,a,b){var g,r,x,y,z,_ref1,_ref2;return void 0!==l&&3===l.length&&(_ref1=l,l=_ref1[0],a=_ref1[1],b=_ref1[2]),void 0!==l&&3===l.length&&(_ref2=l,l=_ref2[0],a=_ref2[1],b=_ref2[2]),y=(l+16)/116,x=y+a/500,z=y-b/200,x=lab_xyz(x)*X,y=lab_xyz(y)*Y,z=lab_xyz(z)*Z,r=xyz_rgb(3.2404542*x-1.5371385*y-.4985314*z),g=xyz_rgb(-.969266*x+1.8760108*y+.041556*z),b=xyz_rgb(.0556434*x-.2040259*y+1.0572252*z),[limit(r,0,255),limit(g,0,255),limit(b,0,255)]},rgb2lab=function(){var b,g,r,x,y,z,_ref1;return _ref1=unpack(arguments),r=_ref1[0],g=_ref1[1],b=_ref1[2],r=rgb_xyz(r),g=rgb_xyz(g),b=rgb_xyz(b),x=xyz_lab((.4124564*r+.3575761*g+.1804375*b)/X),y=xyz_lab((.2126729*r+.7151522*g+.072175*b)/Y),z=xyz_lab((.0193339*r+.119192*g+.9503041*b)/Z),[116*y-16,500*(x-y),200*(y-z)]},lch2lab=function(){var c,h,l,_ref1;return _ref1=unpack(arguments),l=_ref1[0],c=_ref1[1],h=_ref1[2],h=h*Math.PI/180,[l,Math.cos(h)*c,Math.sin(h)*c]},lch2rgb=function(l,c,h){var L,a,b,g,r,_ref1,_ref2;return _ref1=lch2lab(l,c,h),L=_ref1[0],a=_ref1[1],b=_ref1[2],_ref2=lab2rgb(L,a,b),r=_ref2[0],g=_ref2[1],b=_ref2[2],[limit(r,0,255),limit(g,0,255),limit(b,0,255)]},lab_xyz=function(x){return x>.206893034?x*x*x:(x-4/29)/7.787037},xyz_lab=function(x){return x>.008856?Math.pow(x,1/3):7.787037*x+4/29},xyz_rgb=function(r){return Math.round(255*(.00304>=r?12.92*r:1.055*Math.pow(r,1/2.4)-.055))},rgb_xyz=function(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)},lab2lch=function(){var a,b,c,h,l,_ref1;return _ref1=unpack(arguments),l=_ref1[0],a=_ref1[1],b=_ref1[2],c=Math.sqrt(a*a+b*b),h=180*(Math.atan2(b,a)/Math.PI),[l,c,h]},rgb2lch=function(){var a,b,g,l,r,_ref1,_ref2;return _ref1=unpack(arguments),r=_ref1[0],g=_ref1[1],b=_ref1[2],_ref2=rgb2lab(r,g,b),l=_ref2[0],a=_ref2[1],b=_ref2[2],lab2lch(l,a,b)},rgb2hsi=function(){var TWOPI,b,g,h,i,min,r,s,_ref1;return _ref1=unpack(arguments),r=_ref1[0],g=_ref1[1],b=_ref1[2],TWOPI=2*Math.PI,r/=255,g/=255,b/=255,min=Math.min(r,g,b),i=(r+g+b)/3,s=1-min/i,0===s?h=0:(h=(r-g+(r-b))/2,h/=Math.sqrt((r-g)*(r-g)+(r-b)*(g-b)),h=Math.acos(h),b>g&&(h=TWOPI-h),h/=TWOPI),[360*h,s,i]},hsi2rgb=function(h,s,i){var b,g,r,_ref1;return _ref1=unpack(arguments),h=_ref1[0],s=_ref1[1],i=_ref1[2],h/=360,1/3>h?(b=(1-s)/3,r=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3,g=1-(b+r)):2/3>h?(h-=1/3,r=(1-s)/3,g=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3,b=1-(r+g)):(h-=2/3,g=(1-s)/3,b=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3,r=1-(g+b)),r=limit(3*i*r),g=limit(3*i*g),b=limit(3*i*b),[255*r,255*g,255*b]},clip_rgb=function(rgb){var i;for(i in rgb)rgb[i]<0&&(rgb[i]=0),rgb[i]>255&&(rgb[i]=255);return rgb},luminance=function(r,g,b){var _ref1;return _ref1=unpack(arguments),r=_ref1[0],g=_ref1[1],b=_ref1[2],r=luminance_x(r),g=luminance_x(g),b=luminance_x(b),.2126*r+.7152*g+.0722*b},luminance_x=function(x){return x/=255,.03928>=x?x/12.92:Math.pow((x+.055)/1.055,2.4)},chroma.Color=Color,chroma.color=function(x,y,z,m){return new Color(x,y,z,m)},chroma.hsl=function(h,s,l){return new Color(h,s,l,"hsl")},chroma.hsv=function(h,s,v){return new Color(h,s,v,"hsv")},chroma.rgb=function(r,g,b){return new Color(r,g,b,"rgb")},chroma.hex=function(x){return new Color(x)},chroma.css=function(x){return new Color(x)},chroma.lab=function(l,a,b){return new Color(l,a,b,"lab")},chroma.lch=function(l,c,h){return new Color(l,c,h,"lch")},chroma.hsi=function(h,s,i){return new Color(h,s,i,"hsi")},chroma.interpolate=function(a,b,f,m){return null==a||null==b?"#000":("string"===type(a)&&(a=new Color(a)),"string"===type(b)&&(b=new Color(b)),a.interpolate(f,b,m))},chroma.contrast=function(a,b){var l1,l2;return"string"===type(a)&&(a=new Color(a)),"string"===type(b)&&(b=new Color(b)),l1=a.luminance(),l2=b.luminance(),l1>l2?(l1+.05)/(l2+.05):(l2+.05)/(l1+.05)},root="undefined"!=typeof exports&&null!==exports?exports:this,chroma=null!=(_ref1=root.chroma)?_ref1:root.chroma={},Color=chroma.Color,ColorScale=function(){function ColorScale(opts){var me,_ref2,_ref3;null==opts&&(opts={}),me=this,me.range(opts.colors,opts.positions),me._mode=null!=(_ref2=opts.mode)?_ref2:"rgb",me._nacol=chroma.hex(null!=(_ref3=opts.nacol)?_ref3:chroma.hex("#ccc")),me.domain([0,1])}return ColorScale.prototype.range=function(colors,positions){var c,col,me,_i,_j,_ref2,_ref3,_ref4;for(me=this,null==colors&&(colors=["#ddd","#222"]),null!=colors&&"string"===type(colors)&&null!=(null!=(_ref2=chroma.brewer)?_ref2[colors]:void 0)&&(colors=chroma.brewer[colors].slice(0)),c=_i=0,_ref3=colors.length-1;_ref3>=0?_ref3>=_i:_i>=_ref3;c=_ref3>=0?++_i:--_i)col=colors[c],"string"===type(col)&&(colors[c]=new Color(col));if(me._colors=colors,null!=positions)me._pos=positions;else for(me._pos=[],c=_j=0,_ref4=colors.length-1;_ref4>=0?_ref4>=_j:_j>=_ref4;c=_ref4>=0?++_j:--_j)me._pos.push(c/(colors.length-1));return me},ColorScale.prototype.domain=function(domain){var me;return null==domain&&(domain=[]),me=this,me._domain=domain,me._min=domain[0],me._max=domain[domain.length-1],me._numClasses=2===domain.length?0:domain.length-1,me},ColorScale.prototype.get=function(value){var c,f,f0,me;return me=this,isNaN(value)?me._nacol:(me._domain.length>2?(c=me.getClass(value),f=c/(me._numClasses-1)):(f=f0=(value-me._min)/(me._max-me._min),f=Math.min(1,Math.max(0,f))),me.fColor(f))},ColorScale.prototype.fColor=function(f){var col,cols,i,me,p,_i,_ref2;for(me=this,cols=me._colors,i=_i=0,_ref2=me._pos.length-1;_ref2>=0?_ref2>=_i:_i>=_ref2;i=_ref2>=0?++_i:--_i){if(p=me._pos[i],p>=f){col=cols[i];break}if(f>=p&&i===me._pos.length-1){col=cols[i];break}if(f>p&&f<me._pos[i+1]){f=(f-p)/(me._pos[i+1]-p),col=chroma.interpolate(cols[i],cols[i+1],f,me._mode);break}}return col},ColorScale.prototype.classifyValue=function(value){var domain,i,maxc,me,minc,n,val;return me=this,domain=me._domain,val=value,domain.length>2&&(n=domain.length-1,i=me.getClass(value),val=domain[i]+.5*(domain[i+1]-domain[i]),minc=domain[0],maxc=domain[n-1],val=me._min+(val-minc)/(maxc-minc)*(me._max-me._min)),val},ColorScale.prototype.getClass=function(value){var domain,i,n,self;if(self=this,domain=self._domain,null!=domain){for(n=domain.length-1,i=0;n>i&&value>=domain[i];)i++;return i-1}return 0},ColorScale.prototype.validValue=function(value){return!isNaN(value)},ColorScale}(),chroma.ColorScale=ColorScale,chroma.scale=function(colors,positions){var colscale,f,out;return colscale=new chroma.ColorScale,colscale.range(colors,positions),out=!1,f=function(v){var c;return c=colscale.get(v),out&&c[out]?c[out]():c},f.domain=function(domain,classes,mode,key){var d;return null==mode&&(mode="e"),arguments.length?(null!=classes&&(d=chroma.analyze(domain,key),domain=0===classes?[d.min,d.max]:chroma.limits(d,mode,classes)),colscale.domain(domain),f):colscale._domain},f.mode=function(_m){return arguments.length?(colscale._mode=_m,f):colscale._mode},f.range=function(_colors,_pos){return colscale.range(_colors,_pos),f},f.out=function(_o){return out=_o,f},f.getColor=function(val){return f(val)},f},null==(_ref2=chroma.scales)&&(chroma.scales={}),chroma.scales.cool=function(){return chroma.scale([chroma.hsl(180,1,.9),chroma.hsl(250,.7,.4)])},chroma.scales.hot=function(){return chroma.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},chroma.analyze=function(data,key,filter){var add,k,r,val,visit,_i,_len;if(r={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==filter&&(filter=function(){return!0}),add=function(val){null==val||isNaN(val)||(r.values.push(val),r.sum+=val,val<r.min&&(r.min=val),val>r.max&&(r.max=val),r.count+=1)},visit=function(val,k){return filter(val,k)?null!=key&&"function"===type(key)?add(key(val)):null!=key&&"string"===type(key)||"number"===type(key)?add(val[key]):add(val):void 0},"array"===type(data))for(_i=0,_len=data.length;_len>_i;_i++)val=data[_i],visit(val);else for(k in data)val=data[k],visit(val,k);return r.domain=[r.min,r.max],r.limits=function(mode,num){return chroma.limits(r,mode,num)},r},chroma.limits=function(data,mode,num){var assignments,best,centroids,cluster,clusterSizes,dist,i,j,kClusters,limits,max,max_log,min,min_log,mindist,n,nb_iters,newCentroids,p,pb,pr,repeat,sum,tmpKMeansBreaks,value,values,_i,_j,_k,_l,_m,_n,_o,_p,_q,_r,_ref10,_ref11,_ref12,_ref13,_ref14,_ref15,_ref16,_ref17,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_ref9,_s,_t,_u,_v,_w;if(null==mode&&(mode="equal"),null==num&&(num=7),null==data.values&&(data=chroma.analyze(data)),min=data.min,max=data.max,sum=data.sum,values=data.values.sort(function(a,b){return a-b}),limits=[],"c"===mode.substr(0,1)&&(limits.push(min),limits.push(max)),"e"===mode.substr(0,1)){for(limits.push(min),i=_i=1,_ref3=num-1;_ref3>=1?_ref3>=_i:_i>=_ref3;i=_ref3>=1?++_i:--_i)limits.push(min+i/num*(max-min));limits.push(max)}else if("l"===mode.substr(0,1)){if(0>=min)throw"Logarithmic scales are only possible for values > 0";for(min_log=Math.LOG10E*Math.log(min),max_log=Math.LOG10E*Math.log(max),limits.push(min),i=_j=1,_ref4=num-1;_ref4>=1?_ref4>=_j:_j>=_ref4;i=_ref4>=1?++_j:--_j)limits.push(Math.pow(10,min_log+i/num*(max_log-min_log)));limits.push(max)}else if("q"===mode.substr(0,1)){for(limits.push(min),i=_k=1,_ref5=num-1;_ref5>=1?_ref5>=_k:_k>=_ref5;i=_ref5>=1?++_k:--_k)p=values.length*i/num,pb=Math.floor(p),pb===p?limits.push(values[pb]):(pr=p-pb,limits.push(values[pb]*pr+values[pb+1]*(1-pr)));limits.push(max)}else if("k"===mode.substr(0,1)){for(n=values.length,assignments=new Array(n),clusterSizes=new Array(num),repeat=!0,nb_iters=0,centroids=null,centroids=[],centroids.push(min),i=_l=1,_ref6=num-1;_ref6>=1?_ref6>=_l:_l>=_ref6;i=_ref6>=1?++_l:--_l)centroids.push(min+i/num*(max-min));for(centroids.push(max);repeat;){for(j=_m=0,_ref7=num-1;_ref7>=0?_ref7>=_m:_m>=_ref7;j=_ref7>=0?++_m:--_m)clusterSizes[j]=0;for(i=_n=0,_ref8=n-1;_ref8>=0?_ref8>=_n:_n>=_ref8;i=_ref8>=0?++_n:--_n){for(value=values[i],mindist=Number.MAX_VALUE,j=_o=0,_ref9=num-1;_ref9>=0?_ref9>=_o:_o>=_ref9;j=_ref9>=0?++_o:--_o)dist=Math.abs(centroids[j]-value),mindist>dist&&(mindist=dist,best=j);clusterSizes[best]++,assignments[i]=best}for(newCentroids=new Array(num),j=_p=0,_ref10=num-1;_ref10>=0?_ref10>=_p:_p>=_ref10;j=_ref10>=0?++_p:--_p)newCentroids[j]=null;for(i=_q=0,_ref11=n-1;_ref11>=0?_ref11>=_q:_q>=_ref11;i=_ref11>=0?++_q:--_q)cluster=assignments[i],null===newCentroids[cluster]?newCentroids[cluster]=values[i]:newCentroids[cluster]+=values[i];for(j=_r=0,_ref12=num-1;_ref12>=0?_ref12>=_r:_r>=_ref12;j=_ref12>=0?++_r:--_r)newCentroids[j]*=1/clusterSizes[j];for(repeat=!1,j=_s=0,_ref13=num-1;_ref13>=0?_ref13>=_s:_s>=_ref13;j=_ref13>=0?++_s:--_s)if(newCentroids[j]!==centroids[i]){repeat=!0;break}centroids=newCentroids,nb_iters++,nb_iters>200&&(repeat=!1)}for(kClusters={},j=_t=0,_ref14=num-1;_ref14>=0?_ref14>=_t:_t>=_ref14;j=_ref14>=0?++_t:--_t)kClusters[j]=[];for(i=_u=0,_ref15=n-1;_ref15>=0?_ref15>=_u:_u>=_ref15;i=_ref15>=0?++_u:--_u)cluster=assignments[i],kClusters[cluster].push(values[i]);for(tmpKMeansBreaks=[],j=_v=0,_ref16=num-1;_ref16>=0?_ref16>=_v:_v>=_ref16;j=_ref16>=0?++_v:--_v)tmpKMeansBreaks.push(kClusters[j][0]),tmpKMeansBreaks.push(kClusters[j][kClusters[j].length-1]);for(tmpKMeansBreaks=tmpKMeansBreaks.sort(function(a,b){return a-b}),limits.push(tmpKMeansBreaks[0]),i=_w=1,_ref17=tmpKMeansBreaks.length-1;_ref17>=_w;i=_w+=2)isNaN(tmpKMeansBreaks[i])||limits.push(tmpKMeansBreaks[i])}return limits},root="undefined"!=typeof exports&&null!==exports?exports:this,type=function(){var classToType,name,_i,_len,_ref3;for(classToType={},_ref3="Boolean Number String Function Array Date RegExp Undefined Null".split(" "),_i=0,_len=_ref3.length;_len>_i;_i++)name=_ref3[_i],classToType["[object "+name+"]"]=name.toLowerCase();return function(obj){var strType;return strType=Object.prototype.toString.call(obj),classToType[strType]||"object"}}(),null==(_ref3=root.type)&&(root.type=type),Array.max=function(array){return Math.max.apply(Math,array)},Array.min=function(array){return Math.min.apply(Math,array)},limit=function(x,min,max){return null==min&&(min=0),null==max&&(max=1),min>x&&(x=min),x>max&&(x=max),x},unpack=function(args){return 3===args.length?args:args[0]},TWOPI=2*Math.PI,PITHIRD=Math.PI/3,cos=Math.cos,root="undefined"!=typeof exports&&null!==exports?exports:this,chroma=null!=(_ref4=root.chroma)?_ref4:root.chroma={},chroma.brewer=brewer={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},root="undefined"!=typeof exports&&null!==exports?exports:this,chroma=null!=(_ref5=root.chroma)?_ref5:root.chroma={},chroma.colors=colors={indigo:"#4b0082",gold:"#ffd700",hotpink:"#ff69b4",firebrick:"#b22222",indianred:"#cd5c5c",yellow:"#ffff00",mistyrose:"#ffe4e1",darkolivegreen:"#556b2f",olive:"#808000",darkseagreen:"#8fbc8f",pink:"#ffc0cb",tomato:"#ff6347",lightcoral:"#f08080",orangered:"#ff4500",navajowhite:"#ffdead",lime:"#00ff00",palegreen:"#98fb98",darkslategrey:"#2f4f4f",greenyellow:"#adff2f",burlywood:"#deb887",seashell:"#fff5ee",mediumspringgreen:"#00fa9a",fuchsia:"#ff00ff",papayawhip:"#ffefd5",blanchedalmond:"#ffebcd",chartreuse:"#7fff00",dimgray:"#696969",black:"#000000",peachpuff:"#ffdab9",springgreen:"#00ff7f",aquamarine:"#7fffd4",white:"#ffffff",orange:"#ffa500",lightsalmon:"#ffa07a",darkslategray:"#2f4f4f",brown:"#a52a2a",ivory:"#fffff0",dodgerblue:"#1e90ff",peru:"#cd853f",lawngreen:"#7cfc00",chocolate:"#d2691e",crimson:"#dc143c",forestgreen:"#228b22",darkgrey:"#a9a9a9",lightseagreen:"#20b2aa",cyan:"#00ffff",mintcream:"#f5fffa",silver:"#c0c0c0",antiquewhite:"#faebd7",mediumorchid:"#ba55d3",skyblue:"#87ceeb",gray:"#808080",darkturquoise:"#00ced1",goldenrod:"#daa520",darkgreen:"#006400",floralwhite:"#fffaf0",darkviolet:"#9400d3",darkgray:"#a9a9a9",moccasin:"#ffe4b5",saddlebrown:"#8b4513",grey:"#808080",darkslateblue:"#483d8b",lightskyblue:"#87cefa",lightpink:"#ffb6c1",mediumvioletred:"#c71585",slategrey:"#708090",red:"#ff0000",deeppink:"#ff1493",limegreen:"#32cd32",darkmagenta:"#8b008b",palegoldenrod:"#eee8aa",plum:"#dda0dd",turquoise:"#40e0d0",lightgrey:"#d3d3d3",lightgoldenrodyellow:"#fafad2",darkgoldenrod:"#b8860b",lavender:"#e6e6fa",maroon:"#800000",yellowgreen:"#9acd32",sandybrown:"#f4a460",thistle:"#d8bfd8",violet:"#ee82ee",navy:"#000080",magenta:"#ff00ff",dimgrey:"#696969",tan:"#d2b48c",rosybrown:"#bc8f8f",olivedrab:"#6b8e23",blue:"#0000ff",lightblue:"#add8e6",ghostwhite:"#f8f8ff",honeydew:"#f0fff0",cornflowerblue:"#6495ed",slateblue:"#6a5acd",linen:"#faf0e6",darkblue:"#00008b",powderblue:"#b0e0e6",seagreen:"#2e8b57",darkkhaki:"#bdb76b",snow:"#fffafa",sienna:"#a0522d",mediumblue:"#0000cd",royalblue:"#4169e1",lightcyan:"#e0ffff",green:"#008000",mediumpurple:"#9370db",midnightblue:"#191970",cornsilk:"#fff8dc",paleturquoise:"#afeeee",bisque:"#ffe4c4",slategray:"#708090",darkcyan:"#008b8b",khaki:"#f0e68c",wheat:"#f5deb3",teal:"#008080",darkorchid:"#9932cc",deepskyblue:"#00bfff",salmon:"#fa8072",darkred:"#8b0000",steelblue:"#4682b4",palevioletred:"#db7093",lightslategray:"#778899",aliceblue:"#f0f8ff",lightslategrey:"#778899",lightgreen:"#90ee90",orchid:"#da70d6",gainsboro:"#dcdcdc",mediumseagreen:"#3cb371",lightgray:"#d3d3d3",mediumturquoise:"#48d1cc",lemonchiffon:"#fffacd",cadetblue:"#5f9ea0",lightyellow:"#ffffe0",lavenderblush:"#fff0f5",coral:"#ff7f50",purple:"#800080",aqua:"#00ffff",whitesmoke:"#f5f5f5",mediumslateblue:"#7b68ee",darkorange:"#ff8c00",mediumaquamarine:"#66cdaa",darksalmon:"#e9967a",beige:"#f5f5dc",blueviolet:"#8a2be2",azure:"#f0ffff",lightsteelblue:"#b0c4de",oldlace:"#fdf5e6"}
}.call(this)},{}],11:[function(require,module){!function(name,definition){"undefined"!=typeof module?module.exports=definition():"function"==typeof define&&"object"==typeof define.amd?define(definition):this[name]=definition()}("domready",function(ready){function flush(f){for(loaded=1;f=fns.shift();)f()}var fn,fns=[],f=!1,doc=document,testEl=doc.documentElement,hack=testEl.doScroll,domContentLoaded="DOMContentLoaded",addEventListener="addEventListener",onreadystatechange="onreadystatechange",readyState="readyState",loaded=/^loade|c/.test(doc[readyState]);return doc[addEventListener]&&doc[addEventListener](domContentLoaded,fn=function(){doc.removeEventListener(domContentLoaded,fn,f),flush()},f),hack&&doc.attachEvent(onreadystatechange,fn=function(){/^c/.test(doc[readyState])&&(doc.detachEvent(onreadystatechange,fn),flush())}),ready=hack?function(fn){self!=top?loaded?fn():fns.push(fn):function(){try{testEl.doScroll("left")}catch(e){return setTimeout(function(){ready(fn)},50)}fn()}()}:function(fn){loaded?fn():fns.push(fn)}})},{}],9:[function(require,module,exports){"use strict";function embed(){var q,params,pre=document.getElementById("embed");pre&&(params=exports.params(),params.controls="no",q=querystring.stringify(params),pre.textContent='<iframe src="'+location.protocol+"//"+location.host+location.pathname+"?"+q+'"></iframe>')}var querystring=require("querystring");require("domready")(function(){embed()}),exports.controls=function(){return"no"!==exports.params().controls},exports.update=function(id,title,controls){var q,scale,params;history.pushState&&(params=exports.params(),1===arguments.length&&(controls=id,id=null),id&&(params.id=id),params.code=controls.code(),params.stat=controls.stat(),scale=controls.scale(),params.brewer=scale.brewer,params.stops=scale.stops,params.type=scale.type,q="?"+querystring.stringify(params),history.pushState(params,title||"Untitled",q),embed())},exports.params=function(){return querystring.parse(location.search.substr(1))}},{querystring:4,domready:11}],12:[function(require,module){module.exports={11408:403,11409:410,11410:706,11411:701,11412:705,11413:702,11414:703,11415:704,11416:606,11417:603,11418:610,11419:608,11420:602,11366:201,11367:211,11368:205,11369:203,11370:215,11371:214,11372:206,11373:209,11374:207,11375:208,11376:210,11377:204,11378:202,11379:213,11380:212,11381:306,11382:301,11383:308,11384:304,11385:303,11386:307,11387:302,11388:305,11389:507,11390:504,11391:506,11392:505,11393:511,11394:510,11395:501,11396:509,11397:502,11398:503,11399:508,11400:402,11401:407,11402:408,11403:401,11404:406,11405:409,11406:405,11407:404,11421:611,11422:607,11423:604,11424:605,11425:609,11426:601,11427:112,11428:110,11429:106,11430:118,11431:103,11432:117,11433:102,11434:108,11435:120,11436:115,11437:107,11438:114,11439:119,11440:104,11441:101,11442:109,11443:105,11444:113,11445:116,11446:111}},{}],13:[function(require,module){module.exports={101:"San José",102:"Escazú",103:"Desamparados",104:"Puriscal",105:"Tarrazú",106:"Aserrí",107:"Mora",108:"Goicoechea",109:"Santa Ana",110:"Alajuelita",111:"Vázquez de Coronado",112:"Acosta",113:"Tibás",114:"Moravia",115:"Montes de Oca",116:"Turrubares",117:"Dota",118:"Curridabat",119:"Pérez Zeledón",120:"León Cortés",201:"Alajuela",202:"San Ramón",203:"Grecia",204:"San Mateo",205:"Atenas",206:"Naranjo",207:"Palmares",208:"Poás",209:"Orotina",210:"San Carlos",211:"Alfaro Ruiz",212:"Valverde Vega",213:"Upala",214:"Los Chiles",215:"Guatuso",301:"Cartago",302:"Paraíso",303:"La Unión",304:"Jiménez",305:"Turrialba",306:"Alvarado",307:"Oreamuno",308:"El Guarco",401:"Heredia",402:"Barva",403:"Santo Domingo",404:"Santa Bárbara",405:"San Rafael",406:"San Isidro",407:"Belén",408:"Flores",409:"San Pablo",410:"Sarapiquí",501:"Liberia",502:"Nicoya",503:"Santa Cruz",504:"Bagaces",505:"Carrillo",506:"Cañas",507:"Abangares",508:"Tilarán",509:"Nandayure",510:"La Cruz",511:"Hojancha",601:"Puntarenas",602:"Esparza",603:"Buenos Aires",604:"Montes de Oro",605:"Osa",606:"Aguirre",607:"Golfito",608:"Coto Brus",609:"Parrita",610:"Corredores",611:"Garabito",701:"Limón",702:"Pococí",703:"Siquirres",704:"Talamanca",705:"Matina",706:"Guácimo"}},{}],6:[function(require,module){"use strict";function Map(svg){this.svg=svg,this.data={surrogates:{},stats:null,meta:null}}var mappings=require("../../json/gadm-mappings.json"),cantons=require("../../json/cantons.json"),chroma=require("chroma-js");module.exports=Map,Map.prototype.paths=function(){return this.svg.querySelectorAll("#cantons > path")},Map.prototype.meta=function(meta){this.data.meta=meta},Map.prototype.stats=function(stats){var code,stat,surrogate,surrogates;if(arguments.length<1)return this.data.stats;this.data.stats=stats,this.data.surrogates={};for(code in stats)if(stats.hasOwnProperty(code)&&(stat=this.stat(code),"string"==typeof stat)){surrogate=1;break}if(surrogate){surrogates={};for(code in stats)if(stats.hasOwnProperty(code)){if(stat=this.stat(code),null===stat)continue;surrogates.hasOwnProperty(stat)?surrogate=surrogates[stat]:(surrogate++,surrogates[stat]=surrogate),this.data.surrogates[code]=surrogate}}},Map.prototype.clear=function(){var i,l,paths;for(Map.call(this,this.svg),paths=this.paths(),i=0,l=paths.length;l>i;i++)paths[i].style.fill=this.fill()},Map.prototype.code=function(id){return mappings[id]},Map.prototype.canton=function(code){return cantons[code]},Map.prototype.stat=function(code,original){var stat,num;return!original&&this.data.surrogates[code]?this.data.surrogates[code]:(stat=this.data.stats[code],null===stat||void 0===stat||""===stat?null:(num=parseFloat(stat,10),isNaN(num)?stat:num))},Map.prototype.fill=function(id,scale){var stat,code,stripe="url(#stripe)";return!scale||arguments.length<1?stripe:(code=this.code(id),stat=this.stat(code),null===stat?stripe:scale(stat).hex())},Map.prototype.scale=function(brewer,stops,type){var values,scale,paths,i,l,stats=this.data.stats,self=this;for(values=Object.keys(stats).reduce(function(p,c){var stat=self.stat(c);return null!==stat&&p.push(stat),p},[]),scale=chroma.scale(brewer),"linear"!==type?scale.domain(values,stops,type):scale.domain(values,stops),paths=this.paths(),i=0,l=paths.length;l>i;i++)paths[i].style.fill=this.fill(paths[i].id,scale)},Map.prototype.legend=function(scale){var legendEl,colors;return legendEl=document.createElement("ul"),colors=scale.domain().reduce(function(colors,value){var color=scale(value);return colors[color]?colors[color].push(value):colors[color]=[value],colors},{}),Object.keys(colors).forEach(function(color){var colorEl,minVal,maxVal,values=colors[color];minVal=values[0],maxVal=values[values.length-1],colorEl=document.createElement("li"),colorEl.style.borderLeftColor=color,colorEl.textContent=minVal===maxVal?minVal:minVal+" - "+maxVal,legendEl.appendChild(colorEl)}),legendEl}},{"../../json/gadm-mappings.json":12,"../../json/cantons.json":13,"chroma-js":10}]},{},[1]);